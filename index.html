<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8">
<title>ManGaLearn</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Noto+Sans+SC&display=swap" rel="stylesheet">

<style>
/* ========== BASE ========== */
body {
  margin: 0;
  font-family: Roboto, sans-serif;
  background: #0f0f0f;
  color: #eee;
  transition: background 0.6s ease;
  overflow-x: hidden;
}
body.light { background: #fafafa; color: #111; }

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 20px;
}
.logo { height: 48px; }
.logo-link:hover { filter: drop-shadow(0 0 10px crimson); }

.nav a {
  margin: 0 12px;
  color: inherit;
  text-decoration: none;
}

.theme-toggle {
  font-size: 20px;
  cursor: pointer;
  background: none;
  border: none;
  color: inherit;
}

/* ========== WORDS ========== */
.manga-text {
  font-size: 24px;
  text-align: center;
  margin: 60px 20px;
}
.word {
  margin: 0 6px;
  cursor: pointer;
  color: crimson;
}
.word.active { text-shadow: 0 0 10px crimson; }

.tooltip {
  position: fixed;
  background: rgba(0,0,0,0.85);
  color: #fff;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 16px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s ease;
}
.tooltip.show { opacity: 1; }

/* ========== PANELS ========== */
.manga-panel-wrapper {
  display: flex;
  gap: 20px;
  padding: 20px;
  overflow-x: hidden;
}
.manga-panel {
  min-width: 240px;
  height: 340px;
  background: #222;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 14px;
  user-select: none;
  transition: transform 0.2s;
}

/* ========== INK TRANSITION ========== */
#ink {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle, #000 10%, transparent 11%);
  background-size: 20px 20px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
  z-index: 999;
}
#ink.show { opacity: 1; }
</style>
</head>

<body>

<div id="ink"></div>

<header>
  <a href="index.html" class="logo-link">
    <img src="logo.png" class="logo">
  </a>

  <nav class="nav">
    <a href="#">Home</a>
    <a href="#">Lessons</a>
    <a href="#">About</a>
  </nav>

  <button id="themeToggle" class="theme-toggle">ðŸŒ™</button>
</header>

<!-- WORD TEXT -->
<div class="manga-text">
  <span class="word" data-pinyin="NÇ hÇŽo" data-meaning="Ð¡Ð°Ð¹Ð½ ÑƒÑƒ">ä½ å¥½</span>
  <span class="word" data-pinyin="WÇ’men" data-meaning="Ð‘Ð¸Ð´">æˆ‘ä»¬</span>
  <span class="word" data-pinyin="YÃ¬qÇ" data-meaning="Ð¥Ð°Ð¼Ñ‚Ð´Ð°Ð°">ä¸€èµ·</span>
  <span class="word" data-pinyin="XuÃ©xÃ­" data-meaning="Ð¡ÑƒÑ€Ð°Ð»Ñ†ÑŠÑ">å­¦ä¹ </span>
  <span class="word" data-pinyin="ZhÅngwÃ©n" data-meaning="Ð¥ÑÑ‚Ð°Ð´ Ñ…ÑÐ»">ä¸­æ–‡</span>
</div>

<div id="tooltip" class="tooltip"></div>

<!-- PANELS -->
<div class="manga-panel-wrapper" id="panelWrapper">
  <div class="manga-panel">Lesson 1</div>
  <div class="manga-panel">Lesson 2</div>
  <div class="manga-panel">Lesson 3</div>
</div>

<script>
/* ========== SOUND ENGINE (UI) ========== */
const AudioCtx = window.AudioContext || window.webkitAudioContext;
const audioCtx = new AudioCtx();
function uiSound(freq=400, vol=0.05) {
  if (audioCtx.state === "suspended") audioCtx.resume();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.connect(g); g.connect(audioCtx.destination);
  o.frequency.value = freq; g.gain.value = vol;
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.12);
  o.start(); o.stop(audioCtx.currentTime + 0.12);
}

/* ========== WORD CLICK â†’ TOGGLE + AI VOICE ========== */
const tooltip = document.getElementById("tooltip");
let activeWord = null;

document.querySelectorAll(".word").forEach(word => {
  word.addEventListener("click", e => {
    uiSound(600);

    if (activeWord === word) {
      tooltip.classList.remove("show");
      word.classList.remove("active");
      activeWord = null;
      return;
    }

    document.querySelectorAll(".word").forEach(w => w.classList.remove("active"));
    word.classList.add("active");

    tooltip.textContent = `${word.dataset.pinyin} â€” ${word.dataset.meaning}`;
    tooltip.style.left = e.clientX + "px";
    tooltip.style.top = e.clientY - 30 + "px";
    tooltip.classList.add("show");

    activeWord = word;

    /* AI VOICE */
    const utter = new SpeechSynthesisUtterance(word.textContent);
    utter.lang = "zh-CN";
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
  });
});

/* ========== SWIPE + INERTIA PANELS ========== */
const wrapper = document.getElementById("panelWrapper");
let startX=0, currentX=0, velocity=0, dragging=false;

wrapper.addEventListener("touchstart", e=>{
  startX = e.touches[0].clientX;
  dragging = true;
});
wrapper.addEventListener("touchmove", e=>{
  if(!dragging) return;
  currentX = e.touches[0].clientX;
  velocity = currentX - startX;
  wrapper.style.transform = `translateX(${velocity}px)`;
});
wrapper.addEventListener("touchend", ()=>{
  dragging = false;
  wrapper.style.transition = "transform 0.4s ease-out";
  wrapper.style.transform = `translateX(${velocity*0.3}px)`;
  setTimeout(()=> {
    wrapper.style.transition = "";
    wrapper.style.transform = "";
  }, 400);
});

/* ========== DARK / LIGHT INK TRANSITION ========== */
const ink = document.getElementById("ink");
document.getElementById("themeToggle").onclick = () => {
  ink.classList.add("show");
  setTimeout(()=>{
    document.body.classList.toggle("light");
    ink.classList.remove("show");
  }, 300);
};
</script>

</body>
</html>
